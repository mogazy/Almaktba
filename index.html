
<!DOCTYPE html>
<html lang="ar" dir="rtl">


<head>
    <meta name="google-adsense-account" content="ca-pub-3879072798553474">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3879072798553474"
     crossorigin="anonymous"></script>
    <title>تطبيق مكتبتي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
.header {
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000; /* يمكنك تعديل هذه القيمة لضمان ظهور الهيدر فوق العناصر الأخرى */
  background-color: #fff; /* أو أي لون تختاره */
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* لإضافة ظل بسيط */
border-bottom-left-radius: 20px;
  border-bottom-right-radius: 20px;
}


body {
  padding-top: 30px; /* أو أي قيمة تساوي ارتفاع الهيدر، لتجنب تغطية المحتوى */
}

        /* الخط الرئيسي */
        body {
            font-family: 'Inter', sans-serif;
            /* خلفية متدرجة من الأبيض الناصع إلى الرمادي المزرق الباهت جداً */
            background: linear-gradient(to right, #F8F9FA 0%, #EBF2F7 100%); /* أبيض ناصع إلى رمادي مزرق باهت */
            min-height: 100vh;
            color: #333; /* لون نص داكن ليتناسب مع الخلفية الفاتحة */
            overflow-x: hidden;
        }

        /* حاوية صندوق الرسائل */
        .message-box-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .message-box-container.show {
            opacity: 1;
            visibility: visible;
        }

        .message-box {
            background: white; /* خلفية بيضاء لصندوق الرسائل لسهولة القراءة */
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            max-width: 80%;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message-box-title {
            font-size: 20px; /* حجم افتراضي، سيتم تجاوزه بالـ inline style */
            font-weight: bold;
            color: #333;
        }

        .message-box-content {
            font-size: 16px; /* حجم افتراضي، سيتم تجاوزه بالـ inline style */
            color: #555;
        }

        .message-box-button {
            /* لون زر صندوق الرسائل متدرج (أزرق فاتح ومريح) */
            background: linear-gradient(135deg, #66B2FF 0%, #4DA6FF 100%); /* أزرق فاتح مريح */
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.2s ease;
            align-self: center;
        }

        .message-box-button:hover {
            /* تدرج أغمق قليلاً عند التحويم (أزرق متوسط مريح) */
            background: linear-gradient(135deg, #4DA6FF 0%, #3399FF 100%);
        }

        /* زر الترجمة بحالة التحميل */
        .translate-btn.loading {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* تنسيقات الإشعارات الجديدة (منشورات) */
        .notifications-container {
            max-height: 400px; /* لتحديد أقصى ارتفاع يسمح بالتمرير */
            overflow-y: auto; /* إضافة شريط تمرير عمودي */
            padding-right: 10px; /* مسافة داخلية لتجنب تداخل شريط التمرير مع النص */
        }
        .notification-post {
            background-color: #f9fafb; /* Light gray background for notifications */
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0; /* Light border */
            text-align: right; /* محاذاة النص لليمين */
        }

        .notification-post-title {
            font-size: 16px;
            font-weight: 700; /* Bold */
            color: #333; /* Dark text for notifications */
            margin-bottom: 8px;
        }

        .notification-post-description {
            font-size: 16px; /* تم تغيير الحجم إلى 16 بكسل */
            color: #000; /* تم تغيير اللون إلى الأسود */
            margin-bottom: 8px;
            text-align: right;
        }

        .notification-post-image {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 10px;
            display: block; /* لجعل الصورة تأخذ عرضها الكامل وتزيل المساحات البيضاء */
            margin-left: auto; /* لتوسيط الصورة إذا كانت أصغر من العرض الكامل */
            margin-right: auto; /* لتوسيط الصورة إذا كانت أصغر من العرض الكامل */
        }
        
        /* الشعار الجديد بخط جميل */
        .logo-text {
            font-family: 'Amiri', serif; /* تطبيق خط Amiri */
            font-size: 24px; /* حجم الخط */
            font-weight: 700; /* سمك الخط (غامق) */
            /* تدرج لوني للشعار يتناسب مع خلفية الرأس الجديدة */
            background: #FFFFFF; /* أزرق فاتح مريح */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block; /* لجعل التدرج يطبق بشكل صحيح */
        }
        .logo-container .logo { /* إزالة التنسيقات القديمة من الشعار */
            background: none;
            width: auto;
            height: auto;
            border-radius: 0;
            box-shadow: none;
        }

        /* رأس الصفحة (Header) - ألوان جديدة وجميلة ومتدرجة */
        .header {
            background: linear-gradient(135deg, #4A00B2 0%, #8B008B 100%); /* تدرج من أرجواني داكن إلى بنفسجي غامق */
            color: white; /* لون النص ليتناسب مع الخلفية الداكنة */
        }

        /* تعديلات على عنصر المحاضرة لجذبها أكثر */
        .lecture-item {
            padding-top: 20px; /* زيادة المسافة العلوية */
            padding-bottom: 20px; /* زيادة المسافة السفلية */
            border-bottom: 1px solid #e2e8f0; /* خط فاصل خفيف */
            cursor: pointer;
            transition: all 0.2s ease-in-out; /* انتقال سلس للتحويم */
            align-items: flex-start; /* محاذاة العناصر للأعلى */
            border-radius: 12px; /* جعل الإطار منحنيًا */
            margin-bottom: 8px; /* مسافة بين العناصر */
            overflow: hidden; /* لإخفاء أي محتوى يتجاوز الحدود المنحنية */
        }
        .lecture-item:hover {
            background-color: #f3f4f6; /* لون خلفية أفتح عند التحويم */
            transform: scale(1.02); /* تكبير طفيف عند التحويم */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* ظل خفيف عند التحويم */
        }
        /* إزالة آخر حدود لآخر عنصر في القائمة */
        .lecture-item:last-child {
            border-bottom: none;
        }

        /* الجديد: حاوية التدرج اللوني للحدود */
        .gradient-wrapper {
            padding: 2px; /* سمك الحدود المتدرجة */
            border-radius: 12px; /* مطابقة نصف قطر الحدود الخارجية للبطاقة */
            display: flex; /* لتضمين المحتوى الداخلي */
            flex-direction: column;
            height: 100%; /* للتأكد من أنها تملأ الوالد */
        }

        .gradient-wrapper.indigo-gradient {
            /* تدرج لوني للبطاقة الأولى (أزرق فاتح ومريح) */
            background: linear-gradient(135deg, #66B2FF, #4DA6FF);
        }

        .gradient-wrapper.emerald-gradient {
            /* تدرج لوني للبطاقة الثانية (أخضر فاتح ومريح) */
            background: linear-gradient(135deg, #98FB98, #7CFC00); /* أخضر فاتح مريح */
        }

        /* الجديد: المحتوى الداخلي لبطاقات الميزات */
        .feature-card-content {
            background-color: #f5f6fa; /* لون فاتح لخلفية البطاقات الداخلية */
            padding: 15px; /* المسافة البادئة الأصلية */
            border-radius: 10px; /* نصف قطر أصغر قليلاً للزوايا الداخلية المستديرة */
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%; /* تملأ الـ wrapper */
            width: 100%;
        }

        /* تعديل بطاقات الميزات لتضمين التدرج */
        .cards-grid .feature-card {
            background-color: transparent; /* إزالة الخلفية البيضاء الأصلية */
            padding: 0; /* إزالة المسافة البادئة الأصلية */
            border-radius: 12px; /* الحفاظ على نصف قطر الحدود الخارجية */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); /* الحفاظ على الظل */
            transition: all 0.2s ease;
            overflow: hidden; /* مهم لنصف قطر الحدود على التدرج */
        }

        .cards-grid .feature-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15); /* ظل محسن عند التحويم */
        }

        /* تغيير خلفية قسم المحاضرات (تدرج من الأزرق الفاتح إلى الأرجواني الفاتح) */
        .recent-lectures-section {
            background: linear-gradient(135deg, #ADD8E6 0%, #E6E6FA 100%); /* أزرق فاتح إلى أرجواني فاتح */
            color: #333; /* لون نص داكن */
        }
        /* عنوان قسم المحاضرات */
        .recent-lectures-section .section-title {
            color: #4A00B2; /* لون أرجواني داكن ليتناسب مع الخلفية الفاتحة */
            border-color: #B0C4DE; /* لون أزرق رمادي للخط الفاصل */
        }

        /* تغيير تدرج بطاقة الترجمة */
        .translation-card {
            /* تدرج لوني لبطاقة الترجمة (أزرق متوسط ومريح) */
            background: linear-gradient(to bottom right, #3399FF, #1976D2); /* أزرق متوسط ومريح */
            color: white; /* لون نص أبيض */
        }
        .translation-card .translation-input {
            background: rgba(255, 255, 255, 0.3); /* خلفية فاتحة شفافة لمدخل الترجمة */
            color: white; /* نص أبيض */
            border: 1px solid rgba(255, 255, 255, 0.5); /* حدود فاتحة شفافة */
        }
        .translation-card .translation-input::placeholder {
            color: rgba(255, 255, 255, 0.8); /* لون فاتح شفاف للنص البديل */
        }
        .translation-card #translatedTextDisplay {
            background: rgba(255, 255, 255, 0.3); /* خلفية فاتحة شفافة لعرض النص المترجم */
            color: white; /* نص أبيض */
            border: 1px solid rgba(255, 255, 255, 0.5); /* حدود فاتحة شفافة */
        }
        /* تعديل حاوية الأزرار للترجمة والنسخ والمشاركة */
        .translation-buttons-container {
            display: flex;
            flex-wrap: wrap; /* للسماح للأزرار بالانتقال إلى سطر جديد إذا ضاقت المساحة */
            justify-content: flex-end; /* محاذاة الأزرار لليسار في RTL */
            align-items: center;
            gap: 10px; /* مسافة بين الأزرار */
            margin-top: 15px; /* مسافة من الأعلى */
        }

        /* أنماط مشتركة لأزرار الترجمة والنسخ */
        .translation-action-btn {
            background: linear-gradient(135deg, #4DA6FF 0%, #66B2FF 100%); /* تدرج أزرق إلى أزرق فاتح */
            color: white;
            padding: 10px 18px; /* مسافة داخلية مناسبة */
            border-radius: 9999px; /* منحني تماماً */
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px; /* مسافة بين الأيقونة والنص */
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(77, 166, 255, 0.4); /* ظل خفيف */
            border: 1px solid rgba(255, 255, 255, 0.6); /* إطار خفيف */
            white-space: nowrap; /* لمنع النص من الالتفاف */
        }

        .translation-action-btn:hover {
            background: linear-gradient(135deg, #3399FF 0%, #4DA6FF 100%); /* تدرج أغمق قليلاً عند التحويم */
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(77, 166, 255, 0.6);
        }

        .translation-action-btn:active {
            transform: scale(0.95);
        }

        /* زر النسخ - يرث من .translation-action-btn */
        .copy-btn {
            /* يمكن إضافة أنماط خاصة هنا إذا لزم الأمر، ولكنها سترث معظم الأنماط من .translation-action-btn */
        }

        /* رسالة "تم النسخ" */
        .copy-message {
            position: absolute;
            bottom: 100%; /* فوق الزر */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            margin-bottom: 5px; /* مسافة بين الرسالة والزر */
        }
        .copy-btn.copied .copy-message {
            opacity: 1;
            visibility: visible;
        }


        /* تنسيقات عناصر القناة/المجموعة */
        .channel-item {
            display: flex; /* لجعل المحتوى وزر المشاركة في سطر واحد */
            justify-content: space-between; /* لتوزيع المحتوى وزر المشاركة */
            align-items: center; /* لمحاذاة العناصر عمودياً */
            padding-top: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* خط فاصل فاتح شفاف */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            text-align: right; /* محاذاة النص لليمين */
        }
        .channel-item:hover {
            background-color: rgba(102, 178, 255, 0.1); /* لون خلفية أزرق فاتح شفاف عند التحويم */
            transform: scale(1.02); /* تكبير طفيف عند التحويم */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* ظل خفيف عند التحويم */
            border-radius: 12px; /* زوايا دائرية عند التحويم */
        }
        .channel-item:last-child {
            border-bottom: none;
        }
        .channel-info { /* حاوية لاسم ووصف القناة/المجموعة */
            flex-grow: 1; /* لتأخذ المساحة المتبقية */
            text-align: right;
        }

        /* زر المشاركة داخل قائمة القنوات والمجموعات */
        .share-channel-btn {
            background: none;
            border: 1px solid rgba(255, 255, 255, 0.4); /* إطار خفيف */
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap; /* لمنع النص من الالتفاف */
            margin-right: 10px; /* مسافة عن النص في RTL */
        }
        .share-channel-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: white;
        }
        .share-channel-btn i {
            font-size: 1rem;
        }

        /* اللون المميز لبطاقة "أهم القنوات والمجموعات" (أخضر داكن متدرج) */
        .channels-groups-section {
            background: linear-gradient(135deg, #006400 0%, #008000 100%); /* تدرج أخضر داكن */
            color: white; /* لجعل النص أبيض فوق الخلفية الداكنة */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); /* ظل أغمق قليلاً */
        }
        .channels-groups-section .section-title {
            color: white; /* تم تغيير لون العنوان إلى الأبيض */
            border-color: rgba(152, 251, 152, 0.3); /* خط فاصل أخضر فاتح شفاف */
        }

        /* تعديلات على اسم المحاضرة والمحاضر */
        .lecture-name { /* اسم المحاضرة */
            font-size: 1.125rem; /* 18px - حجم أكبر */
            font-weight: bold; /* خط سميك */
            color: #4A00B2; /* لون أرجواني داكن لاسم المحاضرة */
            margin-bottom: 4px; /* مسافة أقل بين العنوان والتفاصيل */
        }
        .lecture-details .lecturer-name { /* اسم المحاضر */
            font-size: 16px; 
            font-weight: bold; 
            color: #555; /* لون نص متوسط لاسم المحاضر */
        }
        .lecture-details {
            color: #777; /* لون رمادي لتفاصيل المحاضرة */
        }

        /* تحريك جرس الإشعارات لجذب الانتباه */
        @keyframes pulse-notification {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .notification-bell-animated {
            animation: pulse-notification 0.3s ease-in-out 0s 10; /* يهتز 10 مرات في 3 ثوانٍ */
        }

        /* أنماط الصفوف الفردية والزوجية للمحاضرات */
        .lecture-item:nth-child(odd) {
            background-color: #F0F5F9; /* لون رمادي مزرق فاتح جداً للصفوف الفردية */
        }
        .lecture-item:nth-child(even) {
            background-color: #FFFFFF; /* لون أبيض للصفوف الزوجية */
        }
        .lecture-item + .lecture-item {
            border-top: 1px solid #E6EFF5; /* خط رفيع بين العناصر بلون رمادي مزرق فاتح */
        }

        /* خلفية الـ main-content بتدرج رمادي خفيف جداً */
        .main-content {
            background: linear-gradient(to bottom, #FDFDFD 0%, #F5F5F5 100%); /* تدرج رمادي خفيف جداً */
            border-radius: 0 0 12px 12px; /* لجعل الزوايا السفلية دائرية إذا كان الـ app-container دائرياً */
        }

        /* زر مشاركة البوت الجديد */
        .share-bot-btn {
            background: linear-gradient(135deg, #00BCD4 0%, #0097A7 100%); /* تدرج أزرق سماوي جذاب */
            color: white;
            padding: 12px 20px;
            border-radius: 10px; /* زوايا مستديرة */
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 188, 212, 0.4); /* ظل خفيف */
            margin-bottom: 20px; /* مسافة تحت الزر */
        }

        .share-bot-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 188, 212, 0.6);
        }
          .red-button{
            background: linear-gradient(135deg, #FF6347, #FF4500); 
            color: white;
            padding: 12px 20px;
            border-radius: 10px; /* زوايا مستديرة */
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px; /* مسافة تحت الزر */
        }
             

  .red-button:hover {
    background: linear-gradient(135deg, #FF4500, #FF6347); /* تأثير الهوفر: عكس التدرج */
    transform: translateY(-2px); /* رفع الزر قليلاً */
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
  }
    </style>
</head>
<body class="font-inter min-h-screen overflow-x:hidden">
    
  <header class="header flex justify-between items-center p-5 relative overflow-hidden">
            <!-- الشعار في أقصى اليمين -->
            <div class="logo-container relative z-10"> 
                <div class="logo">
                    <span class="logo-text">مكتبتي</span>
                </div>
            </div>
            
            <!-- زر البحث تمت إزالته سابقاً -->
            
            <!-- أيقونة الإشعارات في أقصى اليسار -->
            <div class="jrs">
                <svg id="notificationBell" class="header-icon w-7 h-7 cursor-pointer transition-all duration-200 hover:scale-105 relative z-10" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
                </svg>
            </div>
            <div class="flex gap-3 items-center">
  <a href="https://mogazy.github.io/Almaktba/rate.html" class="rate-us-btn">قيم البوت</a>
</div>
<style>

.jrs {
  visibility: hidden;
}
  
  .rate-us-btn {
  background: linear-gradient(135deg, #FFD700 0%, #FF8C00 100%);
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 4px 10px rgba(255, 215, 0, 0.4);
}

.rate-us-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(255, 215, 0, 0.6);
}

</style>
        </header>
<div class="app-container max-w-md mx-auto bg-white bg-opacity-95 backdrop-blur-xl min-h-screen relative shadow-2xl rounded-lg overflow-hidden md:min-h-0 md:my-8 md:rounded-xl">
      

    
        <main class="main-content p-6 pb-24">
            <!-- زر مشاركة البوت الجديد -->
            <button class="share-bot-btn w-full mb-6" id="shareBotButton">
                <i class="fas fa-paper-plane"></i>
                <span>شارك البوت</span>
            </button>





<div>
  <a href="https://mogazy.github.io/Almaktba/blood.html" class="red-button">
    دليل التحليل
  </a>
</div>




            <div class="recent-lectures-section mb-6 rounded-2xl p-5 shadow-lg">
                <h2 class="section-title text-2xl font-bold pb-4 mb-5 text-right border-b">المحاضرات المتوفرة</h2>
                <div id="dynamicLecturesContainer">
                    <div class="text-center text-gray-500 py-4" id="loadingLectures">جاري تحميل المحاضرات...</div>
                </div>
            </div>

            <div class="cards-grid grid grid-cols-2 gap-4 mb-6">
                <div class="feature-card cursor-pointer transition-all duration-200 relative overflow-hidden" id="todayScheduleCard">
                    <div class="gradient-wrapper indigo-gradient">
                        <div class="feature-card-content">
                            <div class="card-icon w-10 h-10 mx-auto mb-3 rounded-lg flex items-center justify-center text-lg text-white">📅</div>
                            <div class="card-title text-sm font-semibold text-gray-800 relative z-10">جدول الأسبوع</div>
                        </div>
                    </div>
                </div>
                <div class="feature-card concept-explainer cursor-pointer transition-all duration-200 relative overflow-hidden">
                    <div class="gradient-wrapper emerald-gradient">
                        <div class="feature-card-content">
                            <div class="card-icon w-10 h-10 mx-auto mb-3 rounded-lg flex items-center justify-center text-lg text-white">💡</div>
                            <div class="card-title text-sm font-semibold text-gray-800 relative z-10">شرح المفاهيم ✨</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="translation-card p-5 rounded-2xl mb-6 relative overflow-hidden">
                <h3 class="mb-4 text-xl font-bold">الترجمة السريعة</h3>
                <input type="text" class="translation-input w-full p-3 rounded-xl mb-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-300" placeholder="اكتب النص للترجمة...">
                
                <div id="translatedTextDisplay" class="p-3 rounded-lg text-sm text-right min-h-[50px] overflow-auto mb-4">
                    <!-- النص المترجم سيظهر هنا -->
                </div>

                <div class="translation-buttons-container">
                    <button class="translate-btn translation-action-btn" id="translateButton">
                        <i class="fas fa-language"></i>
                        <span>ترجم للعربية</span>
                    </button>
                    <button id="copyTranslatedTextBtn" class="copy-btn translation-action-btn">
                        <i class="far fa-copy"></i>
                        <span>نسخ الترجمة</span>
                    </button>
                    <!-- تم إزالة زر مشاركة الترجمة هنا -->
                </div>
            </div>

            <!-- بطاقة أهم القنوات والمجموعات (باللون المميز ومحتوى ديناميكي) -->
            <div class="channels-groups-section mb-6 rounded-2xl p-5 shadow-lg">
                <h2 class="section-title text-xl font-bold pb-4 mb-5 text-right border-b">أهم القنوات والمجموعات</h2>
                <div id="dynamicChannelsGroupsContainer">
                    <div class="text-center text-white py-4" id="loadingChannelsGroups">جاري تحميل القنوات والمجموعات...</div>
                </div>
            </div>

        </main>

        </div>

    <div class="message-box-container" id="messageBoxContainer">
        <div class="message-box">
            <div class="message-box-title" id="messageBoxTitle"></div>
            <div class="message-box-content" id="messageBoxContent"></div>
            <button class="message-box-button" id="messageBoxButton">موافق</button>
        </div>
    </div>

    <script type="module">
        // استيراد وظائف Firebase المطلوبة
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
        import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-analytics.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA85E5iXbpE_Y2VFh2SHC4G5l7wUkh7_Eg",
            authDomain: "almktbh.firebaseapp.com",
            projectId: "almktbh",
            storageBucket: "almktbh.firebasestorage.app",
            messagingSenderId: "506817404401",
            appId: "1:506817404401:web:a826b307ab0fcb72a7f850",
            measurementId: "G-MXNQL6JT3J"
        };

        // تهيئة Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const analytics = getAnalytics(app); 
        let userId = null; // سيتم تحديثه بعد المصادقة المجهولة

        // تعريف مفتاح API وعنوان URL لـ Gemini هنا ليكون متاحاً عالمياً
        const GEMINI_API_KEY = "AIzaSyAc7bJpt_8Ia0azCR8XZtU4oajgyqq-L78"; 
        const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;


        // وظيفة لعرض صندوق رسائل مخصص
        function showMessageBox(titleHtml, messageHtml) {
            const container = document.getElementById('messageBoxContainer');
            document.getElementById('messageBoxTitle').innerHTML = titleHtml; // تم التغيير لاستخدام innerHTML
            document.getElementById('messageBoxContent').innerHTML = messageHtml;
            container.classList.add('show');

            document.getElementById('messageBoxButton').onclick = () => {
                container.classList.remove('show');
            };
        }

        // دالة جلب وعرض الإشعارات من Firebase Firestore بتصميم المنشورات
        async function fetchNotificationsFromFirestore() {
            let notificationsHtml = '<div class="text-center text-gray-500 py-4">جاري تحميل الإشعارات...</div>';
            try {
                // التأكد من تسجيل الدخول المجهول قبل جلب البيانات
                if (!userId) {
                    await signInAnonymously(auth); 
                    userId = auth.currentUser.uid;
                    console.log("تم تسجيل الدخول كمستخدم مجهول. معرف المستخدم:", userId);
                }
                
                const notificationsCol = collection(db, 'notifications'); 
                const q = query(notificationsCol, orderBy('timestamp', 'desc')); 
                const notificationSnapshot = await getDocs(q);
                const notificationsData = notificationSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                if (notificationsData.length === 0) {
                    notificationsHtml = '<div class="text-center text-gray-500 py-4">لا توجد إشعارات حالياً.</div>';
                } else {
                    notificationsHtml = '<div class="notifications-container">'; // حاوية للمنشورات
                    notificationsData.forEach(notification => {
                        const title = notification.title || ''; 
                        const description = notification.description || notification.message || ''; 
                        const imageUrl = notification.imageUrl || ''; 

                        let imageTag = '';
                        if (imageUrl) {
                            imageTag = `<img src="${imageUrl}" alt="صورة إشعار" class="notification-post-image">`;
                        }

                        notificationsHtml += `
                            <div class="notification-post">
                                ${imageTag}
                                <div class="notification-post-title">${title}</div>
                                <div class="notification-post-description">${description}</div>
                            </div>
                        `;
                    });
                    notificationsHtml += '</div>';
                }

            } catch (error) {
                console.error("خطأ في جلب الإشعارات من Firebase:", error);
                notificationsHtml = `<div class="text-center text-red-500 py-4">فشل تحميل الإشعارات: ${error.message}. <br>الرجاء التأكد من تفعيل المصادقة المجهولة (Anonymous) في Firebase والتأكد من قواعد أمان Firestore لمجموعة 'notifications'.</div>`;
            }
            showMessageBox('إشعارات', notificationsHtml); // عرض الإشعارات في صندوق الرسائل
        }

        // دالة جلب وعرض المحاضرات من Firebase Firestore
        async function fetchLecturesFromFirestore() {
            const dynamicLecturesContainer = document.getElementById('dynamicLecturesContainer');
            const loadingLectures = document.getElementById('loadingLectures'); 

            dynamicLecturesContainer.innerHTML = '';
            dynamicLecturesContainer.appendChild(loadingLectures);

            try {
                if (!userId) {
                    await signInAnonymously(auth); 
                    userId = auth.currentUser.uid;
                    console.log("تم تسجيل الدخول كمستخدم مجهول. معرف المستخدم:", userId);
                }
                
                const lecturesCol = collection(db, 'lectures'); 
                const q = query(lecturesCol, orderBy('timestamp', 'desc')); 
                const lectureSnapshot = await getDocs(q);
                const lecturesData = lectureSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                console.log("Lectures data fetched:", lecturesData);

                if (loadingLectures) {
                    loadingLectures.remove();
                }

                if (lecturesData.length === 0) {
                    dynamicLecturesContainer.innerHTML = '<div class="text-center text-gray-500 py-4">لا توجد محاضرات متاحة حالياً في قاعدة البيانات.</div>';
                    return;
                }

                lecturesData.forEach((lecture, index) => {
                    const lectureItem = document.createElement('div');
                    lectureItem.classList.add(
                        'lecture-item', 'flex', 'justify-between', 'items-center', 'py-4',
                        'cursor-pointer', 'transition-all', 'duration-200',
                        'hover:mx-[-20px]', 'hover:px-5', 'hover:rounded-xl',
                        'px-4' // إضافة مسافة بادئة أفقية داخل العنصر
                    );

                    // إضافة الفئات لتبديل الألوان والخط الفاصل
                    if (index % 2 === 0) {
                        lectureItem.classList.add('bg-eef2ff'); // لون أغمق للصفوف الفردية
                    } else {
                        lectureItem.classList.add('bg-f9fafb'); // لون أفتح للصفوف الزوجية
                    }
                    // تم إزالة border-b من هنا لأنه سيتم التعامل معه بواسطة .lecture-item + .lecture-item
                    // lectureItem.classList.add('border-b', 'border-gray-100'); 

                    const lecturerPart = lecture.lecturer ? `<span class="lecturer-name">${lecture.lecturer}</span>` : '';
                    const datePart = lecture.date ? lecture.date : '';
                    let detailsHtml = '';

                    if (lecturerPart && datePart) {
                        detailsHtml = `${lecturerPart} • ${datePart}`;
                    } else if (lecturerPart) {
                        detailsHtml = lecturerPart;
                    } else if (datePart) {
                        detailsHtml = datePart;
                    }

                    lectureItem.innerHTML = `
                        <div class="lecture-info flex-1 text-right">
                            <div class="lecture-name">${lecture.name || ''}</div>
                            <div class="lecture-details text-sm text-gray-600">${detailsHtml}</div>
                        </div>
                    `;

                    lectureItem.addEventListener('click', function() {
                        if (lecture.link) {
                            window.location.href = lecture.link; 
                        } else {
                            // تعديل رسالة صندوق الرسائل لعرض اسم المحاضرة والمحاضر بخط كبير وواضح
                            showMessageBox(
                                `<span style="font-size: 28px; font-weight: bold; color: #4A00B2;">${lecture.name || 'اسم المحاضرة غير متوفر'}</span>`,
                                `<span style="font-size: 24px; font-weight: bold; color: #555;">${lecture.lecturer || 'اسم المحاضر غير متوفر'}</span>`
                            );
                        }
                    });

                    dynamicLecturesContainer.appendChild(lectureItem);
                });

            } catch (error) {
                console.error("خطأ في جلب المحاضرات من Firebase:", error);
                dynamicLecturesContainer.innerHTML = `<div class="text-center text-red-500 py-4">فشل تحميل المحاضرات من Firebase. الرجاء التأكد من إعداد مشروع Firebase الخاص بك، وأن Cloud Firestore مفعّل، وأن قاعدة البيانات تحتوي على مجموعة 'lectures' في الجذر مباشرةً بقواعد أمان تسمح بالقراءة للجميع. تفاصيل الخطأ: ${error.message}. <br>تأكد أيضاً من وجود حقل "timestamp" من نوع Timestamp في مستنداتك للفرز.</div>`;
            }
        }

        // دالة جلب وعرض القنوات والمجموعات من Firebase Firestore
        async function fetchChannelsAndGroupsFromFirestore() {
            const dynamicChannelsGroupsContainer = document.getElementById('dynamicChannelsGroupsContainer');
            const loadingChannelsGroups = document.getElementById('loadingChannelsGroups'); 

            dynamicChannelsGroupsContainer.innerHTML = ''; // مسح المحتوى الحالي
            dynamicChannelsGroupsContainer.appendChild(loadingChannelsGroups); // إضافة رسالة التحميل

            try {
                if (!userId) {
                    await signInAnonymously(auth); 
                    userId = auth.currentUser.uid;
                    console.log("تم تسجيل الدخول كمستخدم مجهول. معرف المستخدم:", userId);
                }
                
                const channelsCol = collection(db, 'channels_and_groups'); // اسم المجموعة في Firestore
                const q = query(channelsCol, orderBy('timestamp', 'desc')); 
                const channelSnapshot = await getDocs(q);
                const channelsData = channelSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                console.log("Channels and Groups data fetched:", channelsData);

                if (loadingChannelsGroups) {
                    loadingChannelsGroups.remove();
                }

                if (channelsData.length === 0) {
                    dynamicChannelsGroupsContainer.innerHTML = '<div class="text-center text-white py-4">لا توجد قنوات أو مجموعات متاحة حالياً.</div>';
                    return;
                }

                channelsData.forEach((channel, index) => {
                    const channelItem = document.createElement('div');
                    channelItem.classList.add(
                        'channel-item', 'py-4', 'cursor-pointer', 'transition-all', 'duration-200', 
                        'hover:bg-opacity-10', 'hover:mx-[-20px]', 'hover:px-5', 'hover:rounded-xl'
                    );

                    if (index < channelsData.length - 1) {
                        channelItem.classList.add('border-b'); // Border color is handled by CSS
                    }

                    const channelInfoDiv = document.createElement('div');
                    channelInfoDiv.classList.add('channel-info');
                    channelInfoDiv.innerHTML = `
                        <div class="channel-name">${channel.name || ''}</div>
                        <div class="channel-description text-sm">${channel.description || ''}</div>
                    `;
                    channelItem.appendChild(channelInfoDiv);

                    // إضافة معالج النقر لعنصر القناة بأكمله
                    channelItem.addEventListener('click', function() {
                        if (channel.link) {
                            window.open(channel.link, '_blank'); // فتح الرابط في نافذة جديدة
                        } else {
                            showMessageBox('رابط غير متوفر', `لا يوجد رابط للقناة/المجموعة: ${channel.name || 'غير متوفر'}.`);
                        }
                    });

                    // زر المشاركة
                    const shareButton = document.createElement('button');
                    shareButton.classList.add('share-channel-btn');
                    shareButton.innerHTML = '<i class="fas fa-share-alt"></i> <span>مشاركة</span>';
                    shareButton.addEventListener('click', async (event) => {
                        event.stopPropagation(); // منع تفعيل حدث النقر على عنصر القناة الأب
                        if (channel.link) {
                            const shareText = `انضم إلى ${channel.name}!`; // تم إزالة "على مكتبتي"
                            const encodedShareText = encodeURIComponent(shareText);
                            const encodedChannelLink = encodeURIComponent(channel.link);
                            const telegramShareUrl = `https://t.me/share/url?url=${encodedChannelLink}&text=${encodedShareText}`;
                            
                            window.open(telegramShareUrl, '_blank'); // فتح الرابط في نافذة جديدة
                        } else {
                            showMessageBox('رابط غير متوفر', `لا يوجد رابط لمشاركة القناة/المجموعة: ${channel.name || 'غير متوفر'}.`);
                        }
                    });
                    channelItem.appendChild(shareButton);

                    dynamicChannelsGroupsContainer.appendChild(channelItem);
                });

            } catch (error) {
                console.error("خطأ في جلب القنوات والمجموعات من Firebase:", error);
                dynamicChannelsGroupsContainer.innerHTML = `<div class="text-center text-red-300 py-4">فشل تحميل القنوات والمجموعات: ${error.message}. <br>الرجاء التأكد من إعداد Firebase الخاص بك وقواعد أمان Firestore لمجموعة 'channels_and_groups'.</div>`;
            }
        }


        document.addEventListener('DOMContentLoaded', function() {
            const featureCards = document.querySelectorAll('.feature-card');
            const translateButton = document.getElementById('translateButton'); 
            const translationInput = document.querySelector('.translation-input');
            const translatedTextDisplay = document.getElementById('translatedTextDisplay'); 
            const notificationBell = document.getElementById('notificationBell'); // أيقونة الجرس
            const copyTranslatedTextBtn = document.getElementById('copyTranslatedTextBtn'); // زر النسخ الجديد
            const shareBotButton = document.getElementById('shareBotButton'); // زر مشاركة البوت الجديد

            // إضافة فئة الحركة إلى جرس الإشعارات عند تحميل الصفحة
            notificationBell.classList.add('notification-bell-animated');

            // استدعاء دالة جلب المحاضرات الديناميكية من Firebase عند تحميل الصفحة
            fetchLecturesFromFirestore();
            // استدعاء دالة جلب القنوات والمجموعات الديناميكية من Firebase عند تحميل الصفحة
            fetchChannelsAndGroupsFromFirestore();

            // ربط حدث النقر لبطاقة "جدول الأسبوع"
            const todayScheduleCard = document.getElementById('todayScheduleCard'); 
            if (todayScheduleCard) {
                todayScheduleCard.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                    // فتح الرابط المحدد لـ "جدول الأسبوع"
                    window.location.href = 'https://t.me/Maktabatylastbot?start=jdwl'; 
                });
            }

            // تأثير النقر على بطاقات الميزات الأخرى
            featureCards.forEach(card => {
                // تجاوز بطاقة "جدول الأسبوع" لأن لديها معالج خاص بها الآن
                if (card.id === 'todayScheduleCard') {
                    return; 
                }

                card.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                    const cardTitle = this.querySelector('.card-title').textContent;
                    if (this.classList.contains('concept-explainer')) {
                        openConceptExplainerModal();
                    } else {
                        showMessageBox('الوصول إلى الميزة', `تم الوصول إلى ميزة: ${cardTitle}`);
                    }
                });
            });

            // وظيفة لفتح مودال شرح المفاهيم (مع اتصال Gemini API)
            async function openConceptExplainerModal() {
                const conceptExplainerContent = `
                    <textarea id="conceptInput" class="w-full p-3 border border-gray-300 rounded-xl mb-4 text-sm bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-300" placeholder="اكتب المفهوم الذي تريد شرحه..."></textarea>
                    <button id="explainConceptBtn" class="bg-indigo-600 text-white px-6 py-2 rounded-full cursor-pointer font-bold transition-all duration-200 hover:bg-indigo-700 active:scale-95">شرح المفهوم ✨</button>
                    <div id="conceptResult" class="mt-4 p-3 bg-blue-50 rounded-lg text-sm text-gray-700 text-right min-h-[50px] overflow-auto"></div>
                `;
                showMessageBox('شرح المفاهيم', conceptExplainerContent);
                document.getElementById('explainConceptBtn').addEventListener('click', explainConcept);
            }

            // وظيفة لمعالجة شرح المفهوم باستخدام Gemini API
            async function explainConcept() {
                const conceptInput = document.getElementById('conceptInput');
                const conceptText = conceptInput.value.trim();
                const explainBtn = document.getElementById('explainConceptBtn');
                const resultDisplay = document.getElementById('conceptResult');

                if (!conceptText) {
                    resultDisplay.textContent = 'الرجاء إدخال مفهوم لشرحه.';
                    return;
                }

                explainBtn.textContent = 'جاري الشرح...';
                explainBtn.classList.add('loading'); 
                explainBtn.disabled = true;
                resultDisplay.textContent = 'جاري المعالجة...'; 

                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: `اشرح المفهوم التالي بوضوح وإيجاز باللغة العربية: "${conceptText}"` }] });
                    
                    const payload = { contents: chatHistory };
                    const response = await fetch(GEMINI_API_URL, { 
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`خطأ في HTTP! الحالة: ${response.status}`);
                    }

                    const result = await response.json();
                    let explanation = "لم يتم العثور على شرح.";

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        explanation = result.candidates[0].content.parts[0].text;
                    }
                    resultDisplay.textContent = explanation;

                } catch (error) {
                    console.error("خطأ في شرح المفهوم:", error);
                    resultDisplay.textContent = 'حدث خطأ أثناء الشرح. الرجاء المحاولة مرة أخرى.';
                } finally {
                    explainBtn.textContent = 'شرح المفهوم ✨';
                    explainBtn.classList.remove('loading'); 
                    explainBtn.disabled = false;
                }
            }


            // وظيفة الترجمة
            translateButton.addEventListener('click', async function() { 
                const text = translationInput.value.trim();
                if (!text) {
                    showMessageBox('خطأ', 'الرجاء إدخال نص للترجمة.');
                    return;
                }

                this.textContent = 'جاري الترجمة...';
                this.classList.add('loading');
                this.disabled = true;

                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: `Translate the following English text into Arabic. Respond with ONLY the translated text, no conversational filler or extra explanations: "${text}"` }] });
                    
                    const payload = { contents: chatHistory };
                    const response = await fetch(GEMINI_API_URL, { 
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    let translatedText = "خطأ في الترجمة";

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        translatedText = result.candidates[0].content.parts[0].text;
                    } else {
                        translatedText = "لم يتم العثور على ترجمة.";
                    }
                    
                    translatedTextDisplay.textContent = translatedText; 
                } catch (error) {
                    console.error("خطأ في الترجمة:", error);
                    translatedTextDisplay.textContent = 'حدث خطأ أثناء الترجمة. الرجاء المحاولة مرة أخرى.';
                } finally {
                    this.innerHTML = '<i class="fas fa-language"></i> <span>ترجم للعربية</span>'; // إعادة النص والأيقونة
                    this.classList.remove('loading');
                    this.disabled = false;
                }
            });

            // وظيفة النسخ إلى الحافظة
            copyTranslatedTextBtn.addEventListener('click', function() {
                const textToCopy = translatedTextDisplay.textContent.trim(); // إزالة المسافات البيضاء الزائدة

                if (!textToCopy) { // التحقق مما إذا كان النص فارغًا
                    showMessageBox('خطأ في النسخ', 'لا يوجد نص لنسخه.');
                    return;
                }
                
                const finalCopyText = textToCopy + " ترجمة مكتبتي @Maktabatylastbot";

                // إنشاء عنصر textarea مؤقت لنسخ النص
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = finalCopyText;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                
                try {
                    document.execCommand('copy');
                    const copyMessage = this.querySelector('.copy-message');
                    copyMessage.classList.add('copied'); // إضافة فئة لإظهار الرسالة
                    setTimeout(() => {
                        copyMessage.classList.remove('copied'); // إزالة الفئة لإخفاء الرسالة
                    }, 1500); // إخفاء الرسالة بعد 1.5 ثانية
                } catch (err) {
                    console.error('Failed to copy text: ', err);
                    showMessageBox('خطأ في النسخ', 'لم يتمكن المتصفح من نسخ النص تلقائياً. الرجاء النسخ يدوياً.');
                } finally {
                    document.body.removeChild(tempTextArea);
                }
            });

            // وظيفة مشاركة البوت عبر تلجرام
            shareBotButton.addEventListener('click', function() {
                const shareText = "جرب افضل بوت محاضرات في العالم , بوت مكتبتي @Maktabatylastbot"; // النص المراد مشاركته
                const encodedText = encodeURIComponent(shareText);

                // استخدام صيغة مشاركة النص فقط
                const telegramShareUrl = `https://t.me/share/text?text=${encodedText}`;
                
                window.open(telegramShareUrl, '_blank'); // فتح الرابط في نافذة جديدة
            });


            // تأثير النقر على أيقونة الإشعارات (الجرس)
            notificationBell.addEventListener('click', fetchNotificationsFromFirestore);
        });
    </script>
</body>
</html>
